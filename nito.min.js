/*! Nito v0.11.0 - https://github.com/morris/nito */
!function(t,e){"function"==typeof define&&define.amd?define([],function(){return e}):"object"==typeof module&&module.exports?module.exports=e:e(t.$)}(this,function(t){function e(t,e){return"function"==typeof t?t.call(e):t}t.nitoId=t.nitoId||0;var i=t.extend,n=t.isArray,r=t.each;t.nito=function(e){var r=function(e,i,n){t.Comp.call(this,e,i,n)};r.prototype=Object.create(t.Comp.prototype),r.prototype.factory=r,i(r,t.Comp);var o=e.base;r.base=t(n(o)?o.join("\n"):o)[0],r.identify=e.identify,r.id=e.id||++t.nitoId;var s=i(r.prototype,e);return delete s.base,delete s.identify,delete s.id,r},t.Comp=function(e,i,n){this.el=e,this.$el=t(e),this.mount(i),this.set(n)},i(t.Comp,{appendTo:function(t,e,i){var n=this.create(e,i);return n.$el.appendTo(t),n},create:function(t,e){return this.mount(this.base?this.base.cloneNode(!0):null,t,e)},mount:function(e,i,n){var r=t(e).eq(0);if(e=r[0],!e)return new this(null,i,n);var s=e.nitoComps=e.nitoComps||{},a=s[this.id];if(a)return a;try{n||(n=JSON.parse(r.attr(o+this.id)||null))}catch(u){console.warn(u)}return a=s[this.id]=new this(e,i,n)},unmount:function(e){if(e=t(e)[0],e&&e.nitoComps){var i=e.nitoComps[this.id];i&&(i.unmount(),delete e.nitoComps[this.id])}},deliver:function(t,e){return this.create(t,e).$el.deliver(!0)}}),i(t.Comp.prototype,{mount:function(){},update:function(){},unmount:function(){},set:function(t){return t&&(this.data=t),this.update(),this},on:function(){var t=this,e=[].map.call(arguments,function(e){return"function"==typeof e?e.bind(t):e});return t.$el.on.apply(t.$el,e),t},find:function(){return this.$el.find.apply(this.$el,arguments)}}),i(t.fn,{mount:function(t,i,n){return this.each(function(){t.mount(this,e(i,this),e(n,this))})},update:function(t,i){return this.comps(t,function(){this.set(e(i,this))})},unmount:function(t){return this.comps(t,function(){this.factory.unmount(this.el)})},comps:function(t,e){if(t&&e){var i=t.id;return this.each(function(){var t=this.nitoComps&&this.nitoComps[i];t&&e.call(t)})}return e=e||t,this.each(function(){r(this.nitoComps||{},e)})},loop:function(e,i,n){var r=this[0];if(r){var o=r.children,s=r.nitoMap=r.nitoMap||{},a=i.identify,u=0,c=e.map(function(t){var e=a?a(t):u+1;if(!e)throw new Error("Invalid key in loop");var r=s[e];return r?(r._sort=Math.abs(u-r._index),r.set(t)):(r=i.create(n,t),s[e]=r,r._sort=-u),r._index=u,r.el.nitoKeep=!0,r.el.nitoKey=e,++u,r});for(u=0;u<o.length;){var h=o[u];h.nitoKeep?++u:(t(h).unmount(),r.removeChild(h),h.nitoKey&&delete s[h.nitoKey])}return c.slice(0).sort(function(t,e){return e._sort-t._sort||e._index-t._index}).forEach(function(t){var e=t.el,i=o[t._index];i?e!==i&&r.insertBefore(e,i):r.appendChild(e),e.nitoKeep=!1}),c}},nest:function(t,e,i){return t?this.loop([t],e,i)[0]:void this.loop([],e,i)},classes:function(i){return this.each(function(){var n=this,o=t(n);r(i,function(t,i){o.toggleClass(t,!!e(i,n))})})},weld:function(t,i){if((null===t||void 0===t)&&(t=""),"object"!=typeof t)return this.each(function(){var i=e(t,this)+"";switch(this.tagName){case"INPUT":case"TEXTAREA":case"SELECT":break;case"IMG":this.src!==i&&(this.src=i);break;default:this.nitoHTML!==i&&(this.innerHTML=this.nitoHTML=i)}});i=i||{};var n=this;return r(t,function(t,e){var r=i[t]||"."+t;n.find(r).weld(e)}),this},values:function(e,i){function r(t){return t.replace(/\]/g,"").split(/\[/g)}function o(t){return t.match(/^\d+$/)?parseInt(t,10):t}var s=this.filter("[name]").add(this.find("[name]"));if(void 0===e)return e={},s.serializeArray().forEach(function(t){for(var i=r(t.name),n=i[0],s=e,a=0,u=i.length-1;u>a;++a){var c=i[a];n=i[a+1];var h=n.match(/^\d*$/)?[]:{};s=s[c]=s[c]||h}""===n?s.push(t.value):s[o(n)]=t.value}),e;var a="value",u="checked",c="selected";return i&&(a="defaultValue",u="defaultChecked",c="defaultSelected"),s.each(function(){var s=e;r(this.name).forEach(function(t){s&&""!==t&&(s=s[o(t)])});var h=t(this),f=this.tagName,l="INPUT"===f?this.type:f;switch((void 0===s||null===s)&&(s=""),l){case"SELECT":var d=this.multiple&&n(s);h.children().each(function(){this[c]=d?s.indexOf(this.getAttribute("value"))>=0:s==this.getAttribute("value")});break;case"TEXTAREA":s+="",this[a]!==s&&(this[a]=s),i&&h.weld(s);break;case"radio":this[u]=s==this.getAttribute("value");break;case"checkbox":this[u]=n(s)?s.indexOf(this.getAttribute("value"))>=0:!!s;break;case"button":case"file":case"image":case"reset":case"submit":break;default:s+="",this[a]!==s&&(this[a]=s)}}),this},reset:function(){return this.each(function(){switch(this.tagName){case"FORM":this.reset();break;case"INPUT":"checkbox"===this.type||"radio"===this.type?this.checked=this.defaultChecked:this.value=this.defaultValue;break;case"TEXTAREA":this.value=this.defaultValue;break;case"OPTION":this.selected=this.defaultSelected;break;case"SELECT":t(this).children().reset()}}),this},deliver:function(e){return this.comps(function(){var t=this.factory.id;"string"==typeof t&&this.$el.attr(o+t,JSON.stringify(this.data))}),e?t("<div></div>").append(this[0]).html():this}});var o="data-nito-";return t});