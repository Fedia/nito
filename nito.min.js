/*! Nito v0.10.0 - https://github.com/morris/nito */
!function(t,e){"function"==typeof define&&define.amd?define([],function(){return e}):"object"==typeof module&&module.exports?module.exports=e:e(t.$)}(this,function(t){function e(t,e){return"function"==typeof t?t.call(e):t}if(t.nito)return t;var i=t.extend,n=t.isArray,r=t.each;t.nito=function(e){var r=function(e,i,n){t.Comp.call(this,e,i,n)};r.prototype=Object.create(t.Comp.prototype),r.prototype.factory=r,i(r,t.Comp);var s=e.base;r.base=t(n(s)?s.join("\n"):s)[0],r.identify=e.identify,r.id=e.id||++t.nitoId;var a=i(r.prototype,e);return delete a.base,delete a.identify,delete a.id,r},t.Comp=function(e,i,n){this.el=e,this.$el=t(e),this.mount(i),this.set(n)},i(t.Comp,{appendTo:function(t,e,i){var n=this.create(e,i);return n.$el.appendTo(t),n},create:function(t,e){return this.mount(this.base?this.base.cloneNode(!0):null,t,e)},mount:function(e,i,n){var r=t(e).eq(0);if(e=r[0],!e)return new this(null,i,n);var a=e.nitoComps=e.nitoComps||{},o=a[this.id];if(o)return o;try{n||(n=JSON.parse(r.attr(s+this.id)||null))}catch(u){console.warn(u)}return o=a[this.id]=new this(e,i,n)},deliver:function(t,e){return this.create(t,e).$el.deliver(!0)}}),t.nitoId=0,i(t.Comp.prototype,{mount:function(){},update:function(){},set:function(t){return t&&(this.data=t),this.update(),this},on:function(){var t=this,e=[].map.call(arguments,function(e){return"function"==typeof e?e.bind(t):e});return t.$el.on.apply(t.$el,e),t},find:function(){return this.$el.find.apply(this.$el,arguments)}}),i(t.fn,{mount:function(t,i,n){return this.each(function(){t.mount(this,e(i,this),e(n,this))})},update:function(t,i){return this.comps(t,function(){this.set(e(i,this))})},comps:function(t,e){if(t&&e){var i=t.id;return this.each(function(){var t=this.nitoComps&&this.nitoComps[i];t&&e.call(t)})}return e=e||t,this.each(function(){r(this.nitoComps||{},e)})},loop:function(t,e,i){var n=this[0];if(n){var r=n.children,s=n.nitoMap=n.nitoMap||{},a=e.identify,o=0,u=t.map(function(t){var n=a?a(t):o+1;if(!n)throw new Error("Invalid key in loop");var r=s[n];return r?(r._sort=Math.abs(o-r._index),r.set(t)):(r=e.create(i,t),s[n]=r,r._sort=-o),r._index=o,r.el.nitoKeep=!0,r.el.nitoKey=n,++o,r});for(o=0;o<r.length;){var c=r[o];c.nitoKeep?++o:(n.removeChild(c),c.nitoKey&&delete s[c.nitoKey])}return u.slice(0).sort(function(t,e){return e._sort-t._sort||e._index-t._index}).forEach(function(t){var e=t.el,i=r[t._index];i?e!==i&&n.insertBefore(e,i):n.appendChild(e),e.nitoKeep=!1}),u}},nest:function(t,e,i){return t?this.loop([t],e,i)[0]:void this.loop([],e,i)},classes:function(i){return this.each(function(){var n=this,s=t(n);r(i,function(t,i){s.toggleClass(t,!!e(i,n))})})},weld:function(t,i){if((null===t||void 0===t)&&(t=""),"object"!=typeof t)return this.each(function(){var i=e(t,this)+"";switch(this.tagName){case"INPUT":case"TEXTAREA":case"SELECT":break;case"IMG":this.src!==i&&(this.src=i);break;default:(this.nitoHTML||this.innerHTML)!==i&&(this.innerHTML=this.nitoHTML=i)}});i=i||{};var n=this;return r(t,function(t,e){var r=i[t]||"."+t;n.find(r).weld(e)}),this},values:function(e,i){function r(t){return t.replace(/\]/g,"").split(/\[/g)}function s(t){return t.match(/^\d+$/)?parseInt(t,10):t}var a=this.filter("[name]").add(this.find("[name]"));if(void 0===e)return e={},a.serializeArray().forEach(function(t){for(var i=r(t.name),n=i[0],a=e,o=0,u=i.length-1;u>o;++o){var c=i[o];n=i[o+1];var h=n.match(/^\d*$/)?[]:{};a=a[c]=a[c]||h}""===n?a.push(t.value):a[s(n)]=t.value}),e;var o="value",u="checked",c="selected";return i&&(o="defaultValue",u="defaultChecked",c="defaultSelected"),a.each(function(){var a=e;r(this.name).forEach(function(t){a&&""!==t&&(a=a[s(t)])});var h=t(this),f=this.tagName,l="INPUT"===f?this.type:f;switch((void 0===a||null===a)&&(a=""),l){case"SELECT":var d=this.multiple&&n(a);h.children().each(function(){this[c]=d?a.indexOf(this.getAttribute("value"))>=0:a==this.getAttribute("value")});break;case"TEXTAREA":this[o]=a+"",i&&h.html(a+"");break;case"radio":this[u]=a==this.getAttribute("value");break;case"checkbox":this[u]=n(a)?a.indexOf(this.getAttribute("value"))>=0:!!a;break;case"button":case"file":case"image":case"reset":case"submit":break;default:this[o]=a+""}}),this},reset:function(){return this.each(function(){switch(this.tagName){case"FORM":this.reset();break;case"INPUT":"checkbox"===this.type||"radio"===this.type?this.checked=this.defaultChecked:this.value=this.defaultValue;break;case"TEXTAREA":this.value=this.defaultValue;break;case"OPTION":this.selected=this.defaultSelected;break;case"SELECT":t(this).children().reset()}}),this},deliver:function(e){return this.comps(function(){var t=this.factory.id;"string"==typeof t&&this.$el.attr(s+t,JSON.stringify(this.data))}),e?t("<div></div>").append(this[0]).html():this}});var s="data-nito-";return t});